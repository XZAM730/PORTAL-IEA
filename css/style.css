/* =========================================
   IEA PORTAL - MAIN STYLESHEET v3
   "Neon Cosmos" Premium Design
   Depends on: theme.css
   ========================================= */

/* ─── LEGACY VARIABLE BRIDGE ─── */
:root {
  --bg:          var(--bg-darkest);
  --accent:      var(--primary);
  --accent-sec:  var(--secondary);
  --accent-glow: var(--glow-primary);
  --text-pri:    var(--text-primary);
  --text-sec:    var(--text-secondary);
  --dock-bg:     var(--glass-heavy);

  --bg-img-1: radial-gradient(var(--glow-primary-sm), transparent 2px);
  --bg-img-2: radial-gradient(rgba(6, 214, 255, 0.12), transparent 2px);
  --bg-img-3: radial-gradient(rgba(249, 115, 22, 0.08), transparent 2px);
}

[data-theme="light"] {
  --bg:          var(--bg-light);
  --accent:      var(--primary);
  --accent-sec:  var(--secondary-dark);
  --accent-glow: var(--glow-primary);
  --text-pri:    var(--text-primary-light);
  --text-sec:    var(--text-secondary-light);
}

/* =========================================
   1. BODY & BACKGROUND
   ========================================= */
body {
  background-color: var(--bg-darkest);
  background-image: var(--bg-img-1), var(--bg-img-2), var(--bg-img-3);
  background-size: 500px 500px, 280px 280px, 350px 350px;
  background-position: 0 0, 80px 120px, 160px 40px;
  transition: background var(--trans-slow), color var(--trans-slow);
}

/* Light mode bg */
[data-theme="light"] body {
  --bg-img-1: radial-gradient(rgba(124, 58, 237, 0.07), transparent 2px);
  --bg-img-2: radial-gradient(rgba(6, 214, 255, 0.05), transparent 2px);
  --bg-img-3: radial-gradient(rgba(249, 115, 22, 0.05), transparent 2px);
}

/* ── Noise Texture ── */
.texture-layer {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  z-index: -10; opacity: 0.08; pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='f'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23f)' opacity='0.5'/%3E%3C/svg%3E");
  mix-blend-mode: overlay;
}

/* ── Ambient Orbs (Orbiting Blobs) ── */
body::before, body::after {
  content: ''; position: fixed; border-radius: 50%;
  filter: blur(120px); z-index: -2; pointer-events: none;
}
body::before {
  width: 80vw; height: 80vw; top: -20%; left: -20%;
  background: radial-gradient(circle at 40% 40%, rgba(168, 85, 247, 0.18), rgba(124, 58, 237, 0.06) 50%, transparent 70%);
  animation: orbit 50s infinite alternate var(--ease-in-out);
}
body::after {
  width: 60vw; height: 60vw; bottom: -15%; right: -15%;
  background: radial-gradient(circle at 60% 60%, rgba(6, 214, 255, 0.12), rgba(249, 115, 22, 0.08) 50%, transparent 70%);
  animation: orbit 35s infinite alternate-reverse var(--ease-in-out);
  animation-delay: -15s;
}

/* ── Third ambient blob ── */
.bg-blob-mid {
  position: fixed; width: 40vw; height: 40vw;
  top: 40%; left: 40%; transform: translate(-50%, -50%);
  background: radial-gradient(circle, rgba(249, 115, 22, 0.06), transparent 70%);
  border-radius: 50%; filter: blur(80px);
  z-index: -2; pointer-events: none;
  animation: orbit 60s infinite alternate var(--ease-in-out);
  animation-delay: -25s;
}

/* =========================================
   2. PROGRESS BAR
   ========================================= */
.progress-container {
  position: fixed; top: 0; z-index: var(--z-toast);
  width: 100%; height: 2px; background: transparent;
}
.progress-bar {
  height: 2px; width: 0%;
  background: linear-gradient(90deg, var(--primary-dark), var(--primary), var(--tertiary));
  background-size: 200% auto;
  box-shadow: 0 0 12px var(--glow-primary), 0 0 4px var(--glow-cyan);
  transition: width 0.3s ease;
  animation: gradientShift 3s linear infinite;
  position: relative; overflow: hidden;
}
.progress-bar::after {
  content: '';
  position: absolute; top: 0; right: 0; width: 60px; height: 100%;
  background: linear-gradient(to left, rgba(255,255,255,0.8), transparent);
  animation: shimmer 1.5s infinite;
}

/* =========================================
   3. LAYOUT
   ========================================= */
.wrap {
  max-width: 940px; margin: 0 auto;
  padding: 55px 20px 150px 20px;
  position: relative; z-index: var(--z-card);
  opacity: 0; transform: scale(0.98) translateY(8px);
  transition: opacity 1.2s var(--ease-smooth), transform 1.2s var(--ease-smooth);
}
.wrap.loaded { opacity: 1; transform: scale(1) translateY(0); }

/* =========================================
   4. HEADER
   ========================================= */
header {
  text-align: center;
  margin-bottom: 45px; margin-top: 25px;
}

.status-pill {
  display: inline-flex; align-items: center; gap: var(--sp-2);
  padding: 5px 16px;
  border: 1px solid var(--glass-border);
  color: var(--text-secondary);
  font-family: var(--font-sans); font-size: 0.72rem; letter-spacing: 0.8px;
  border-radius: var(--radius-full);
  background: rgba(168, 85, 247, 0.06);
  backdrop-filter: var(--blur-sm);
  text-transform: uppercase;
}

header h1 {
  font-family: var(--font-display);
  font-size: clamp(2rem, 6vw, 3.75rem);
  font-weight: 900; letter-spacing: 3px; margin-top: 16px;
  line-height: 1.15;
  background: linear-gradient(135deg, #fff 0%, var(--primary-light) 40%, var(--tertiary) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  filter: drop-shadow(0 0 30px var(--glow-primary));
}

header p {
  color: var(--text-secondary); margin-top: 10px;
  font-size: 0.88rem; letter-spacing: 0.3px;
}

#user-display-name {
  cursor: pointer; transition: var(--trans-fast);
  color: var(--primary-light);
  border-bottom: 1px dashed rgba(168, 85, 247, 0.4);
  padding-bottom: 1px;
}
#user-display-name:hover {
  color: var(--tertiary);
  border-bottom-color: var(--tertiary);
  filter: drop-shadow(0 0 8px var(--glow-cyan));
}

.iea-glow {
  color: var(--primary);
  font-weight: 800; font-family: var(--font-display);
  filter: drop-shadow(0 0 8px var(--glow-primary));
}

/* =========================================
   5. SEARCH BAR
   ========================================= */
.search-container {
  position: relative; max-width: 420px; margin: 28px auto 0;
  transition: var(--trans-normal);
}
.search-container:focus-within {
  transform: scale(1.015);
  filter: drop-shadow(0 8px 20px var(--glow-primary-sm));
}

#portalSearch {
  width: 100%;
  padding: 13px 20px 13px 48px;
  background: rgba(168, 85, 247, 0.05);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  color: var(--text-primary);
  font-family: var(--font-sans); font-size: 0.9rem;
  transition: var(--trans-normal); outline: none;
}
#portalSearch::placeholder { color: var(--text-muted); }
#portalSearch:focus {
  border-color: var(--primary);
  background: rgba(168, 85, 247, 0.08);
  box-shadow: 0 0 0 3px var(--glow-primary-sm), 0 8px 20px rgba(0,0,0,0.2);
}

.search-icon {
  position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
  width: 18px; height: 18px; fill: var(--text-muted);
  transition: fill var(--trans-fast);
}
.search-container:focus-within .search-icon { fill: var(--primary); }

/* =========================================
   6. MARQUEE (ANNOUNCEMENT BAR)
   ========================================= */
.announcement-bar {
  width: 100%;
  background: linear-gradient(90deg, transparent, rgba(168, 85, 247, 0.06), rgba(6, 214, 255, 0.04), transparent);
  border-top: 1px solid rgba(168, 85, 247, 0.15);
  border-bottom: 1px solid rgba(6, 214, 255, 0.10);
  padding: 9px 0; overflow: hidden;
  position: relative; z-index: var(--z-sticky);
}
.announcement-bar::before, .announcement-bar::after {
  content: ''; position: absolute; top: 0; bottom: 0; width: 80px; z-index: 1; pointer-events: none;
}
.announcement-bar::before { left: 0; background: linear-gradient(to right, var(--bg-darkest), transparent); }
.announcement-bar::after  { right: 0; background: linear-gradient(to left, var(--bg-darkest), transparent); }

.marquee-text {
  display: inline-block; white-space: nowrap;
  font-family: var(--font-sans); font-size: 0.75rem;
  color: var(--text-secondary); letter-spacing: 1.2px;
  animation: marquee 40s linear infinite;
}
@keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

.status-indicator {
  display: flex; justify-content: center; gap: 18px; margin-bottom: 28px;
  font-size: 0.68rem; font-family: var(--font-sans);
  color: var(--text-muted); letter-spacing: 0.5px;
}

/* =========================================
   7. GRID & CARDS
   ========================================= */
.grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
@media(min-width: 640px)  { .grid { grid-template-columns: repeat(2, 1fr); gap: 18px; } }
@media(min-width: 1024px) { .grid { grid-template-columns: repeat(3, 1fr); gap: 20px; } }

.card {
  background: var(--glass);
  border: 1px solid var(--glass-border-subtle);
  border-radius: var(--radius-lg); padding: 22px;
  position: relative; overflow: hidden;
  backdrop-filter: var(--blur-md); -webkit-backdrop-filter: var(--blur-md);
  cursor: pointer;
  transition: all 0.5s var(--ease-smooth);
  box-shadow: 0 4px 20px rgba(0,0,0,0.3), inset 0 1px 0 var(--glass-highlight);
  animation: fadeInUp 0.6s var(--ease-smooth) both;
}

/* Gradient inner shine */
.card::before {
  content: ''; position: absolute;
  top: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent, var(--glass-highlight), transparent);
  pointer-events: none;
}

/* Subtle category stripe */
.card::after {
  content: ''; position: absolute;
  top: 0; left: 0; bottom: 0; width: 2px;
  background: transparent;
  transition: background var(--trans-normal);
}

.card:hover {
  transform: translateY(-9px) scale(1.015);
  border-color: rgba(168, 85, 247, 0.35);
  box-shadow: 0 24px 50px -12px var(--glow-primary),
              0 8px 16px rgba(0,0,0,0.4),
              inset 0 1px 0 var(--glass-highlight);
  background: linear-gradient(135deg, var(--glass), rgba(168, 85, 247, 0.07));
}
.card:hover::after { background: linear-gradient(180deg, var(--primary), var(--tertiary)); }
.card:active { transform: scale(0.975); transition-duration: 0.1s; }

/* Card stagger delays */
.card:nth-child(1) { animation-delay: 0ms; }
.card:nth-child(2) { animation-delay: 60ms; }
.card:nth-child(3) { animation-delay: 120ms; }
.card:nth-child(4) { animation-delay: 180ms; }
.card:nth-child(5) { animation-delay: 240ms; }
.card:nth-child(6) { animation-delay: 300ms; }
.card:nth-child(n+7) { animation-delay: 360ms; }

.card-tag {
  font-family: var(--font-sans); font-size: 0.62rem; font-weight: 700;
  color: var(--secondary-light);
  display: inline-block; margin-bottom: 10px;
  padding: 3px 9px; border-radius: var(--radius-sm);
  background: rgba(249, 115, 22, 0.12);
  border: 1px solid rgba(249, 115, 22, 0.20);
  letter-spacing: 0.8px; text-transform: uppercase;
}

.card h2 {
  font-family: var(--font-display); font-size: 1.0rem; font-weight: 700;
  margin-bottom: 6px; color: var(--text-primary);
  display: flex; align-items: center; justify-content: space-between;
}
.card p { font-size: 0.83rem; color: var(--text-secondary); line-height: 1.6; font-weight: 400; }

.card-icon {
  width: 20px; height: 20px; fill: var(--text-muted);
  transition: fill 0.4s, transform 0.4s var(--ease-spring);
  position: absolute; top: 22px; right: 22px;
}
.card:hover .card-icon { fill: var(--primary); transform: rotate(12deg) scale(1.2); }

.sys-footer {
  text-align: center; margin-top: 35px;
  font-family: var(--font-mono); font-size: 0.65rem;
  color: var(--text-muted); opacity: 0.5;
  letter-spacing: 1px;
}

/* =========================================
   8. MODALS
   ========================================= */
.modal {
  position: fixed; inset: 0;
  background: rgba(4, 4, 10, 0.85);
  z-index: var(--z-modal);
  display: none; justify-content: center; align-items: center;
  padding: 20px;
  backdrop-filter: var(--blur-md);
  -webkit-backdrop-filter: var(--blur-md);
  transition: opacity var(--trans-slow);
}
.modal.active { display: flex; }

.modal-box {
  width: 100%; max-width: 460px;
  background: linear-gradient(145deg, var(--bg-surface), var(--bg-medium));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-xl);
  padding: 32px;
  text-align: center;
  box-shadow: 0 30px 80px rgba(0,0,0,0.6), 0 0 0 1px var(--glass-highlight),
              inset 0 1px 0 var(--glass-highlight);
  animation: scaleIn 0.4s var(--ease-spring);
  color: var(--text-primary);
  max-height: 88vh; overflow-y: auto;
  position: relative;
}
/* Top accent line */
.modal-box::before {
  content: ''; position: absolute; top: 0; left: 10%; right: 10%; height: 1px;
  background: linear-gradient(90deg, transparent, var(--primary), var(--tertiary), transparent);
  border-radius: var(--radius-full);
}

.btn-action {
  width: 100%; padding: 13px;
  background: var(--grad-primary);
  color: #fff; font-weight: 700;
  border: none; border-radius: var(--radius-md);
  margin-top: 22px; cursor: pointer;
  font-family: var(--font-sans); font-size: 0.95rem;
  transition: all var(--trans-normal);
  box-shadow: 0 6px 20px var(--glow-primary-sm);
  letter-spacing: 0.3px;
}
.btn-action:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 30px var(--glow-primary);
  filter: brightness(1.1);
}
.btn-action:active { transform: translateY(0) scale(0.98); }

.btn-close {
  margin-top: 14px; color: var(--text-muted);
  font-size: 0.78rem; cursor: pointer;
  transition: color var(--trans-fast); font-family: var(--font-sans);
  display: inline-block; padding: 4px var(--sp-3); border-radius: var(--radius-sm);
}
.btn-close:hover { color: var(--text-primary); background: var(--glass); }

.btn-danger {
  width: 100%; padding: 11px;
  background: rgba(239, 68, 68, 0.12);
  color: #fca5a5; font-weight: 600;
  border: 1px solid rgba(239, 68, 68, 0.35);
  border-radius: var(--radius-md); cursor: pointer;
  font-family: var(--font-sans); transition: all var(--trans-normal);
}
.btn-danger:hover {
  background: var(--accent-red); color: #fff;
  box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
  border-color: var(--accent-red);
}

/* =========================================
   9. PROTOCOL SCREEN
   ========================================= */
#protocol-screen {
  position: fixed; inset: 0;
  background: radial-gradient(ellipse at 50% -20%, rgba(168, 85, 247, 0.08), transparent 60%), var(--bg-void);
  z-index: 30000;
  display: flex; flex-direction: column;
  justify-content: center; align-items: center;
  padding: 20px;
  transition: opacity 1s var(--ease-smooth);
}

.protocol-box {
  width: 100%; max-width: 560px;
  background: linear-gradient(145deg, var(--bg-surface), var(--bg-medium));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-xl);
  padding: 30px;
  box-shadow: 0 30px 80px rgba(0,0,0,0.7), 0 0 60px rgba(168, 85, 247, 0.06);
  position: relative; overflow: hidden;
}
.protocol-box::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--primary-dark), var(--primary), var(--tertiary));
}

.protocol-header {
  font-family: var(--font-display); font-size: 1.0rem; color: var(--text-primary);
  margin-bottom: 22px;
  border-bottom: 1px solid var(--glass-border-subtle);
  padding-bottom: 16px;
  display: flex; justify-content: space-between; align-items: center;
  font-weight: 700; letter-spacing: 0.5px;
}
.protocol-content {
  font-family: var(--font-sans); font-size: 0.88rem;
  color: var(--text-secondary); line-height: 1.7;
  max-height: 320px; overflow-y: auto; margin-bottom: 22px;
  padding-right: 8px;
}
.protocol-content h4 {
  color: var(--text-primary); margin-top: 16px; margin-bottom: 6px;
  font-family: var(--font-display); font-size: 0.85rem; letter-spacing: 0.5px;
}
.protocol-content ul { padding-left: 18px; margin-bottom: 10px; }
.protocol-content li { margin-bottom: 5px; color: var(--text-secondary); }

.protocol-confirm {
  display: flex; align-items: center; gap: 14px; margin-top: 20px;
  border-top: 1px solid var(--glass-border-subtle); padding-top: 20px;
}
.custom-checkbox {
  width: 22px; height: 22px; border: 2px solid var(--secondary);
  display: flex; justify-content: center; align-items: center;
  cursor: pointer; transition: all var(--trans-normal); border-radius: var(--radius-sm);
  flex-shrink: 0;
}
.custom-checkbox:hover { border-color: var(--secondary-light); box-shadow: 0 0 10px var(--glow-secondary); }
.custom-checkbox.checked { background: var(--grad-secondary); border-color: transparent; }
.custom-checkbox i { color: #fff; font-size: 12px; display: none; }
.custom-checkbox.checked i { display: block; }

#btn-init {
  flex: 1; padding: 13px;
  background: var(--glass); color: var(--text-muted);
  border: 1px solid var(--glass-border); border-radius: var(--radius-md);
  font-family: var(--font-display); font-size: 0.8rem; letter-spacing: 1.5px;
  cursor: not-allowed; transition: all var(--trans-slow); font-weight: 700;
}
#btn-init.active {
  background: var(--grad-primary); color: #fff;
  border-color: transparent; cursor: pointer;
  box-shadow: 0 6px 25px var(--glow-primary);
}
#btn-init.active:hover { transform: translateY(-2px); box-shadow: 0 10px 35px var(--glow-primary); }

/* =========================================
   10. LOADER SCREEN
   ========================================= */
#loader-overlay {
  position: fixed; inset: 0;
  background: radial-gradient(ellipse at 50% 30%, rgba(168, 85, 247, 0.05), transparent 60%), var(--bg-void);
  z-index: 20000; display: none;
  flex-direction: column; align-items: center; justify-content: center;
  transition: opacity 0.8s var(--ease-smooth); pointer-events: none;
}
.loader-text {
  font-family: var(--font-display); font-size: 0.72rem; font-weight: 700;
  letter-spacing: 4px; text-transform: uppercase; margin-top: 28px;
  background: var(--grad-neon);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  animation: pulse 1.5s ease-in-out infinite;
}
.loader-logo-wrap {
  width: 110px; height: 110px;
  opacity: 0; animation: fadeIn 1.2s var(--ease-smooth) forwards;
}

/* =========================================
   11. BRANDING & NAVIGATION
   ========================================= */

/* Logo SVG */
.logo-svg { overflow: visible; filter: drop-shadow(0 0 14px var(--glow-primary)); }
.ring { fill: none; stroke-width: 2.5; vector-effect: non-scaling-stroke; }
.ring-1 {
  stroke: var(--primary); transform-origin: center;
  animation: spin 18s linear infinite; opacity: 0.9;
}
.ring-2 {
  stroke: var(--tertiary); transform-origin: center;
  animation: spinRev 12s linear infinite; opacity: 0.7;
}
.ring-3 {
  stroke: var(--secondary); transform-origin: center;
  animation: spin 25s linear infinite; opacity: 0.5;
}

/* Corner Brand */
.corner-brand {
  position: fixed; top: 20px; left: 22px; z-index: 8000;
  display: flex; align-items: center; gap: 10px; opacity: 0;
  transition: opacity 2s;
}
.corner-logo { width: 32px; height: 32px; }
.corner-text {
  font-family: var(--font-display); font-weight: 800;
  font-size: 0.85rem; letter-spacing: 1.5px; text-transform: uppercase;
  color: var(--text-primary); display: none;
}
@media(min-width: 768px) { .corner-text { display: block; } }

/* Settings Button */
.settings-btn {
  position: fixed; top: 20px; right: 20px; z-index: 8000;
  width: 44px; height: 44px; border-radius: var(--radius-md);
  background: var(--glass); border: 1px solid var(--glass-border);
  color: var(--text-secondary);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: all var(--trans-normal);
  backdrop-filter: var(--blur-sm);
  box-shadow: var(--shadow-sm);
}
.settings-btn:hover {
  border-color: var(--primary); color: var(--primary);
  transform: rotate(90deg);
  box-shadow: 0 0 20px var(--glow-primary-sm);
}

/* FAB */
.fab-container {
  position: fixed; bottom: 40px; right: 24px; z-index: 9999;
  display: flex; flex-direction: column-reverse; align-items: center; gap: 12px;
}
.fab-main {
  width: 56px; height: 56px;
  background: var(--grad-primary);
  border-radius: 50%; border: none;
  display: flex; justify-content: center; align-items: center;
  box-shadow: 0 8px 24px var(--glow-primary), 0 0 0 0 var(--glow-primary);
  cursor: pointer; transition: all 0.5s var(--ease-spring);
  animation: glow 4s ease-in-out infinite;
}
.fab-main svg { width: 26px; height: 26px; fill: white; transition: transform 0.5s var(--ease-spring); }
.fab-menu {
  display: flex; flex-direction: column; gap: 10px;
  opacity: 0; transform: translateY(15px) scale(0.95);
  pointer-events: none;
  transition: all 0.35s var(--ease-spring);
}
.fab-container.active .fab-menu {
  opacity: 1; transform: translateY(0) scale(1); pointer-events: auto;
}
.fab-container.active .fab-main {
  transform: rotate(45deg);
  background: var(--grad-secondary);
  animation: none;
}
.fab-item {
  width: 44px; height: 44px; background: var(--glass-heavy);
  border: 1px solid var(--glass-border); backdrop-filter: var(--blur-sm);
  border-radius: 50%; display: flex; justify-content: center; align-items: center;
  cursor: pointer; transition: all var(--trans-normal);
  position: relative; box-shadow: var(--shadow-md);
}
.fab-item:hover {
  background: var(--primary); border-color: var(--primary);
  box-shadow: 0 0 20px var(--glow-primary);
  transform: scale(1.1);
}
.fab-item:hover svg { fill: #fff; }
.fab-item svg { width: 18px; height: 18px; fill: var(--text-secondary); transition: fill var(--trans-fast); }
.fab-item::after {
  content: attr(data-label); position: absolute; right: 56px;
  background: var(--glass-heavy); color: var(--text-primary);
  border: 1px solid var(--glass-border);
  padding: 4px 10px; border-radius: var(--radius-sm);
  font-size: 0.68rem; white-space: nowrap; backdrop-filter: var(--blur-sm);
  opacity: 0; transition: opacity var(--trans-fast); pointer-events: none;
}
.fab-item:hover::after { opacity: 1; }

/* Back To Top */
#backToTop {
  position: fixed; bottom: 40px; left: 20px;
  width: 44px; height: 44px; background: var(--glass);
  border: 1px solid var(--glass-border); backdrop-filter: var(--blur-sm);
  border-radius: var(--radius-md);
  display: flex; justify-content: center; align-items: center;
  cursor: pointer; opacity: 0; transform: translateY(20px);
  transition: all var(--trans-slow); z-index: 9998;
}
#backToTop.show { opacity: 1; transform: translateY(0); }
#backToTop:hover {
  border-color: var(--primary);
  box-shadow: 0 0 20px var(--glow-primary-sm);
}
#backToTop svg { width: 22px; height: 22px; fill: var(--primary); }

/* =========================================
   12. SETTINGS & TOGGLES
   ========================================= */
.setting-row {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 14px; color: var(--text-primary); font-size: 0.88rem;
}
.setting-row span { display: flex; align-items: center; gap: var(--sp-2); }

/* Toggle Switch */
.switch { position: relative; display: inline-block; width: 46px; height: 22px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider {
  position: absolute; cursor: pointer; inset: 0;
  background: var(--bg-elevated);
  border: 1px solid var(--glass-border);
  transition: var(--trans-normal); border-radius: var(--radius-full);
}
.slider:before {
  position: absolute; content: "";
  height: 14px; width: 14px; left: 3px; bottom: 3px;
  background: var(--text-muted); transition: var(--trans-normal); border-radius: 50%;
}
input:checked + .slider {
  background: var(--primary);
  border-color: var(--primary);
  box-shadow: 0 0 10px var(--glow-primary-sm);
}
input:checked + .slider:before {
  transform: translateX(24px);
  background: white;
}

/* Range Slider */
input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
  background: var(--primary); cursor: pointer; margin-top: -6px;
  box-shadow: 0 0 8px var(--glow-primary-sm);
  transition: box-shadow var(--trans-fast);
}
input[type=range]::-webkit-slider-thumb:hover { box-shadow: 0 0 15px var(--glow-primary); }
input[type=range]::-webkit-slider-runnable-track {
  width: 100%; height: 4px; cursor: pointer;
  background: linear-gradient(90deg, var(--primary) var(--range-fill, 50%), var(--glass-border) 0%);
  border-radius: var(--radius-full);
}

/* =========================================
   13. TOAST NOTIFICATIONS
   ========================================= */
.toast {
  background: var(--glass-heavy);
  border: 1px solid var(--glass-border);
  border-left: 3px solid var(--primary);
  color: var(--text-primary); padding: 12px 18px;
  border-radius: var(--radius-md);
  margin-bottom: 10px; font-family: var(--font-sans); font-size: 0.8rem;
  box-shadow: var(--shadow-md), 0 0 20px rgba(0,0,0,0.3);
  animation: toastIn 0.4s var(--ease-spring) forwards,
             toastOut 0.4s var(--ease-smooth) 3.6s forwards;
  backdrop-filter: var(--blur-md); max-width: 300px;
  display: flex; align-items: center; gap: var(--sp-3);
}
.toast.success { border-left-color: var(--accent-green); }
.toast.error   { border-left-color: var(--accent-red); }
.toast.warning { border-left-color: var(--accent-gold); }
.toast.info    { border-left-color: var(--tertiary); }

@keyframes toastIn  { from { transform: translateX(-110%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
@keyframes toastOut { to   { transform: translateX(-110%); opacity: 0; } }

/* =========================================
   14. SYSTEM MODES
   ========================================= */

/* Low Graphics Mode */
body.low-graphics .card,
body.low-graphics .settings-btn,
body.low-graphics .modal-box,
body.low-graphics .protocol-box,
body.low-graphics .fab-item,
body.low-graphics #backToTop,
body.low-graphics .status-pill,
body.low-graphics .toast {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: var(--bg-dark) !important;
  border-color: var(--glass-border) !important;
}

/* No Motion Mode */
body.no-motion *,
body.no-motion *::before,
body.no-motion *::after {
  animation: none !important;
  transition: none !important;
}
